```mermaid
å¥½çš„ï¼Œæ ¹æ®æ‚¨çš„æè¿°å’Œæä¾›çš„ GCN_PAD_Model Python ä»£ç ï¼Œæ‚¨çš„æ–°æ¨¡åž‹æž¶æž„ç‰¹ç‚¹æ˜¯ï¼š

æ›¿æ¢åˆå§‹ç¼–ç å™¨ï¼š ç”¨ Input Embedding æ›¿ä»£äº†åŽŸå›¾çš„ STD Mambaã€‚

åŒåˆ†æ”¯ç»“æž„ï¼š ä¿ç•™äº† H-PAD çš„æ ¸å¿ƒåŒåˆ†æ”¯ï¼ˆPatch/Multi-scale å’Œ GCNï¼‰ã€‚

è®°å¿†æ¨¡å—ï¼š ä¸¤ä¸ªåˆ†æ”¯éƒ½ä½¿ç”¨ Memory Module è¿›è¡Œç‰¹å¾çš„æå–å’Œé‡æž„ã€‚

æœ€ç»ˆèžåˆï¼š ä¸¤ä¸ªåˆ†æ”¯çš„é‡æž„è¾“å‡ºé€šè¿‡ä¸€ä¸ªå¯å­¦ä¹ çš„å‚æ•° 
ð›¾
Î³
 è¿›è¡ŒåŠ æƒèžåˆã€‚

æˆ‘ä»¬å°†å‚ç…§æ‚¨æä¾›çš„ç¬¬äºŒä¸ªåŽŸå›¾ï¼ˆDual-Domain Memory Moduleï¼‰çš„é£Žæ ¼ï¼Œä¸ºæ‚¨ç”Ÿæˆè¿™ä¸ªæ–°çš„æ¨¡åž‹æ¡†å›¾ã€‚

ç”±äºŽ TikZ ä»£ç è¾ƒé•¿ï¼Œè¯·ä½¿ç”¨ Overleaf ç­‰åœ¨çº¿ LaTeX ç¼–è¾‘å™¨è¿›è¡Œç¼–è¯‘ï¼Œå³å¯ç”Ÿæˆ PDF æ ¼å¼çš„å›¾ç‰‡ã€‚

æ–°æ¨¡åž‹æ¡†æž¶å›¾ (TikZ ä»£ç )
code
Latex
download
content_copy
expand_less
\documentclass[border=10pt]{standalone}
\usepackage{tikz}
\usetikzlibrary{shapes, positioning, arrows.meta, backgrounds, fit, calc}
\usepackage{amsmath}

\begin{document}
\begin{tikzpicture}[
    >=Stealth,
    % Styles adapted from the reference image
    featurebox/.style={draw, thick, fill=white, minimum width=2.5cm, minimum height=2.5cm, inner sep=2pt, align=left},
    modulebox/.style={rectangle, draw, thick, rounded corners, minimum height=3.5cm, minimum width=6cm, align=center},
    initialbox/.style={rectangle, draw=blue!50, dashed, fill=blue!5!white, minimum height=2cm, minimum width=2.5cm, text width=2cm, align=center},
    finalbox/.style={rectangle, draw=green!50!black, dashed, fill=green!10, minimum height=2cm, minimum width=2.5cm, text width=2cm, align=center},
    symbol/.style={circle, draw, fill=white, inner sep=1pt, minimum size=6pt},
    databar/.style={rectangle, fill=#1!40, minimum height=0.2cm, minimum width=2cm, inner sep=0pt, node distance=0.1cm},
    % Legend colors
    read_arrow/.style={-{Stealth}, blue, thick},
    residual_arrow/.style={-{Stealth}, red, thick},
]

% -------------------------
% 1. Initial Processing (Replacing STD Mamba)
% -------------------------
\node[initialbox, fill=gray!10, draw=black] (Embedding) at (0, 0) {Input \\ Embedding};
\node (InputText) at (-2.5, 0) {Input \\ Time Series};
\draw[->, black] (InputText) -- (Embedding);
\coordinate (FeatSplit) at (Embedding.east);

% -------------------------
% 2. Main Dual-Branch Memory Module Container
% -------------------------
\node[rectangle, draw=red, thick, rounded corners=8pt, minimum width=15cm, minimum height=11cm, inner sep=10pt, line width=1.5pt] (MainModule) at (6.5, 0) {};
\node at (6.5, 5.2) {\textbf{Dual-Branch Memory Module (Patch \& GCN)}};

% -------------------------
% 3. Left Side: Origin Features
% -------------------------
\node[align=center] at (2.5, 4.3) {\textbf{Origin}};

% --- Patch Feature (Upper) ---
\node[featurebox] (FzBox) at (2.5, 2.5) {};
\node at (2.5, 3.8) {Patch Feature};
\node[anchor=north] at (FzBox.north) {$F^Z \in \mathbb{R}^{L \times D}$};
\node[databar=cyan, anchor=north] (F1z) at ($(FzBox.north)+(0,-0.4)$) {$F^Z_1$};
\node[databar=cyan, anchor=north] (F2z) at ($(F1z.south)+(0, -0.1)$) {$F^Z_2$};
\node at (2.5, 1.8) {$\dots$};
\node[databar=cyan, anchor=south] (FLz) at ($(FzBox.south)+(0, 0.4)$) {$F^Z_L$};

% --- GCN Feature (Lower) ---
\node[featurebox] (FgBox) at (2.5, -2.5) {};
\node at (2.5, -1.2) {GCN Feature};
\node[anchor=north] at (FgBox.north) {$F^G \in \mathbb{R}^{L \times D}$};
\node[databar=blue, anchor=north] (F1g) at ($(FgBox.north)+(0,-0.4)$) {$F^G_1$};
\node[databar=blue, anchor=north] (F2g) at ($(F1g.south)+(0, -0.1)$) {$F^G_2$};
\node at (2.5, -3.2) {$\dots$};
\node[databar=blue, anchor=south] (FLg) at ($(FgBox.south)+(0, 0.4)$) {$F^G_L$};

% Split Arrows
\draw[read_arrow] (FeatSplit) -- (1.5, 0) -- (1.5, 2.5) -- (FzBox.west);
\draw[read_arrow] (FeatSplit) -- (1.5, 0) -- (1.5, -2.5) -- (FgBox.west);


% -------------------------
% 4. Center: Memory Modules
% -------------------------
\coordinate (MemCenter) at (6.5, 0);

% --- Patch Branch Memory (Upper) ---
\node[modulebox, fill=gray!5] (PatchMem) at (MemCenter |- 2.5) {
    \textbf{Patch Memory Module}
    \begin{scope}[shift={(0, -0.4)}, node distance=0.15cm]
        \node[databar=orange!50, anchor=west] (M1p) at (-2.5, 0.5) {$M^Z_1$};
        \node[databar=orange!50, anchor=north] (M2p) at ($(M1p.south)+(0, -0.1)$) {$M^Z_2$};
        \node at (-1.5, -0.5) {$\dots$};
        \node[databar=cyan!50, anchor=south] (MNp) at ($(M2p.south)+(0, -0.6)$) {$M^Z_N$};
        \node[rectangle, draw, fill=white, minimum width=3cm, minimum height=0.5cm, anchor=south] (SoftmaxP) at (MNp.north |- 1.7) {Softmax};
    \end{scope}
};
\node at (6.5, 4.3) {$M^Z \in \mathbb{R}^{N \times D}$};

% Connect Patch Query to Softmax (Read Process)
\draw[read_arrow] (FzBox.east) -- (4, 2.5) -- (4, 3.8) -- (SoftmaxP.west |- 4, 3.8);

% --- GCN Branch Memory (Lower) ---
\node[modulebox, fill=gray!5] (GCNMem) at (MemCenter |- -2.5) {
    \textbf{GCN Memory Module}
    \begin{scope}[shift={(0, -0.4)}, node distance=0.15cm]
        \node[databar=orange!50, anchor=west] (M1g) at (-2.5, 0.5) {$M^G_1$};
        \node[databar=orange!50, anchor=north] (M2g) at ($(M1g.south)+(0, -0.1)$) {$M^G_2$};
        \node at (-1.5, -0.5) {$\dots$};
        \node[databar=cyan!50, anchor=south] (MNg) at ($(M2g.south)+(0, -0.6)$) {$M^G_N$};
        \node[rectangle, draw, fill=white, minimum width=3cm, minimum height=0.5cm, anchor=south] (SoftmaxXg) at (MNg.north |- 1.7) {Softmax};
    \end{scope}
};
\node at (6.5, -0.7) {$M^G \in \mathbb{R}^{N \times D}$};

% Connect GCN Query to Softmax (Read Process)
\draw[read_arrow] (FgBox.east) -- (4, -2.5) -- (4, -1.2) -- (SoftmaxXg.west |- 4, -1.2);


% -------------------------
% 5. Core Memory Operations (Weights and Reconstruction)
% -------------------------
\coordinate (WeightP) at (8.5, 2.5);
\coordinate (WeightG) at (8.5, -2.5);

% Patch Weights/Reconstruction
\node[featurebox, minimum width=1.5cm] (WpBox) at (WeightP) {};
\node[anchor=north] at (WpBox.north) {$W^Z$};
\node[anchor=south] at (WpBox.south) {$V^Z$};
\draw[read_arrow] (SoftmaxP.east) -- (7.5, 3.8) -- (7.5, 2.8) -- (WpBox.north); % Softmax Output (Attention)
\draw[read_arrow] (PatchMem.east) -- (WpBox.south); % Memory Content (Value)
\node[symbol] (MulP) at (7.8, 2.5) {$\otimes$}; % Matrix Multiplication

% GCN Weights/Reconstruction
\node[featurebox, minimum width=1.5cm] (WgBox) at (WeightG) {};
\node[anchor=north] at (WgBox.north) {$W^G$};
\node[anchor=south] at (WgBox.south) {$V^G$};
\draw[read_arrow] (SoftmaxXg.east) -- (7.5, -1.2) -- (7.5, -2.2) -- (WgBox.north); % Softmax Output (Attention)
\draw[read_arrow] (GCNMem.east) -- (WgBox.south); % Memory Content (Value)
\node[symbol] (MulG) at (7.8, -2.5) {$\otimes$}; % Matrix Multiplication

% Gating Mechanism (Red Cross between memory modules, as in source image)
\node[symbol] (GateZ) at (6.5, 0.5) {$\boxtimes$};
\node[symbol] (GateG) at (6.5, -0.5) {$\boxtimes$};
\draw[residual_arrow] (PatchMem.south) -- (GateZ);
\draw[residual_arrow] (GCNMem.north) -- (GateG);
\draw[residual_arrow] (GateZ) -- (GCNMem.north);
\draw[residual_arrow] (GateG) -- (PatchMem.south);


% -------------------------
% 6. Right Side: Reconstruction
% -------------------------
\node[align=center] at (11.5, 4.3) {\textbf{Reconstruction}};

% --- Patch Reconstruction (Upper) ---
\node[featurebox, fill=green!10] (RecZBox) at (11.5, 2.5) {};
\node at (11.5, 3.8) {Patch Reconstruction};
\node[anchor=north] at (RecZBox.north) {$\hat{F}^Z \in \mathbb{R}^{L \times D}$};
\node[databar=green!60, anchor=north] (R1z) at ($(RecZBox.north)+(0,-0.4)$) {$\hat{F}^Z_1$};
\node at (11.5, 2.5) {$\dots$};
\node[databar=green!60, anchor=south] (RLz) at ($(RecZBox.south)+(0, 0.4)$) {$\hat{F}^Z_L$};
\draw[read_arrow] (WpBox.east) -- (RecZBox.west); % Result of M*W

% Residual Update for Patch
\node[symbol, fill=red!10] (SubZ) at (10, 4) {$\ominus$};
\draw[read_arrow] (RecZBox.north) -- (SubZ);
\draw[residual_arrow] (FzBox.north) -- (3.5, 4) -- (SubZ);
\draw[residual_arrow] (SubZ) -- (PatchMem.north);

% --- GCN Reconstruction (Lower) ---
\node[featurebox, fill=green!10] (RecGBox) at (11.5, -2.5) {};
\node at (11.5, -1.2) {GCN Reconstruction};
\node[anchor=north] at (RecGBox.north) {$\hat{F}^G \in \mathbb{R}^{L \times D}$};
\node[databar=green!60, anchor=north] (R1g) at ($(RecGBox.north)+(0,-0.4)$) {$\hat{F}^G_1$};
\node at (11.5, -2.5) {$\dots$};
\node[databar=green!60, anchor=south] (RLg) at ($(RecGBox.south)+(0, 0.4)$) {$\hat{F}^G_L$};
\draw[read_arrow] (WgBox.east) -- (RecGBox.west); % Result of M*W

% Residual Update for GCN
\node[symbol, fill=red!10] (SubG) at (10, -1) {$\ominus$};
\draw[read_arrow] (RecGBox.north) -- (SubG);
\draw[residual_arrow] (FgBox.north) -- (3.5, -1) -- (SubG);
\draw[residual_arrow] (SubG) -- (GCNMem.north);


% -------------------------
% 7. Final Fusion and Output
% -------------------------
\coordinate (FusionPoint) at (13.5, 0);

% Connect Reconstructions to Fusion
\draw[read_arrow] (RecZBox.east) -- (FusionPoint |- 2.5);
\draw[read_arrow] (RecGBox.east) -- (FusionPoint |- -2.5);
\draw (FusionPoint |- 2.5) -- (FusionPoint);
\draw (FusionPoint |- -2.5) -- (FusionPoint);

% Fusion Gate (Gamma)
\node[symbol, draw=purple, fill=purple!10] (GammaGate) at (FusionPoint) {$\gamma \cdot \oplus$};
\node at (13.5, -0.7) {Weighted Fusion};

% Final Decoder
\node[finalbox] (FinalDecoder) at (16, 0) {Non-linear Decoder};
\draw[read_arrow] (GammaGate) -- (FinalDecoder);

% Final Output
\node (OutputText) at (18.5, 0) {Reconstruct \\ Time Series};
\draw[->, black] (FinalDecoder) -- (OutputText);


% -------------------------
% 8. Legend
% -------------------------
\node[draw=gray, dashed, minimum width=3cm, minimum height=2.5cm, inner sep=5pt, anchor=north west] (Legend) at (16, 5) {};

\node at (16.2, 4.5) {
    \begin{tabular}{ll}
        \tikz \draw[read_arrow] (0,0) -- (0.5,0); & Read process \\
        \tikz \draw[residual_arrow] (0,0) -- (0.5,0); & Residual update mechanism \\
        \tikz \node[symbol] {$\oplus$}; & Summation/Concatenate \\
        \tikz \node[symbol] {$\otimes$}; & Matrix multiplication \\
        \tikz \node[symbol, fill=red!10] {$\ominus$}; & Matrix subtraction \\
        \tikz \node[symbol, draw=red, fill=white] {$\boxtimes$}; & Gating mechanism (Memory) \\
    \end{tabular}
};

\end{tikzpicture}
\end{document}
```